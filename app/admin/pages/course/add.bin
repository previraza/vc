<?php viewOnlyBy('ADMIN'); $pageTitle = "Nouveau Cours" ?>

<div class="card height-auto">
    <div class="card-body">
        <div class="heading-layout1">
            <div class="item-title">
                <h3>Ajouter une Nouvelle Cours</h3>
            </div>
            <div class="dropdown">
                <a class="dropdown-toggle" href="#" role="button" 
                data-toggle="dropdown" aria-expanded="false">...</a>

                <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="#" data-action="print"><i class="fas fa-print"></i>print</a>
                    
                    <a class="dropdown-item" href="#" data-action="reload"><i class="fas fa-redo-alt text-orange-peel"></i>Actualiser</a>
                </div>
            </div>
        </div>
        <form class="new-added-form" id="addClass">
            <div class="row">
                <div class="col-xl-3 col-lg-6 col-12 form-group">
                    <label><?=$mci?></label>
                    <select class="select2" name="section" id="s_sec">
                        <?php $rqt = mysqli_query($db, "SELECT * FROM sections WHERE active = 1") or die(debug(mysqli_error($db)));
                            while ($ROW = mysqli_fetch_array($rqt)){ $row = (object) $ROW; $_fs = isset($_fs) ? $_fs : $ROW['id']?>
                                <option value="<?= $row->id ?>"><?= $row->name ?></option>
                        <?php } ?>
                        <option value="*">Toutes les <?=$mci?>s</option>
                        <input type="hidden" name="CON_47" value="true">
                    </select>
                </div>
                <div class="col-xl-3 col-lg-6 col-12 form-group">
                    <label>Option</label>
                    <select class="select2" name="option" id="s_opt">
                        <?php $rqt = mysqli_query($db, "SELECT * FROM options WHERE active = 1 AND ".($_fs=='*'?'1':'section = '.$_fs)) or die(debug(mysqli_error($db)));
                            while ($ROW = mysqli_fetch_array($rqt)){ $row = (object) $ROW; ?>
                                <option value="<?= $row->id ?>"><?= $row->name ?></option>
                            <?php } ?>
                            <option value="*">Toutes les options</option>
                    </select>
                </div>
                <div class="col-xl-3 col-lg-6 col-12 form-group">
                    <label>Niveau *</label>
                    <select class="select2" name="level">
                        <?php $rqt = mysqli_query($db, "SELECT * FROM level WHERE active = 1") or die(debug(mysqli_error($db)));
                            while ($ROW = mysqli_fetch_array($rqt)){ $row = (object) $ROW; ?>
                                <option value="<?= $row->id ?>"><?= $row->name ?></option>
                        <?php } ?>
                        <input type="hidden" name="CON_47" value="true">
                    </select>
                </div>
                <div class="col-xl-3 col-lg-6 col-12 form-group">
                    <label>Promotion *</label>
                    <select class="select2" name="promotion">
                        <?php $year = 2023;
                            while ($year > 2021){ ?>
                                <option value="<?= --$year ?>"><?= $year." - ".($year+1); ?></option>
                        <?php } ?>
                        <input type="hidden" name="CON_47" value="true">
                    </select>
                </div>
                <div class="col-xl-4 col-lg-6 col-12 form-group">
                    <label>Designation *</label>
                    <input type="text" name="name" placeholder="" class="form-control">
                </div>
                <div class="col-xl-3 col-lg-6 col-12 form-group">
                    <label>Enseignant titulaire *</label>
                    <select class="select2" name="titular">
                        <?php $rqt = mysqli_query($db, "SELECT * FROM teachers WHERE active = 1 AND valide = 1 ORDER BY title DESC, firstname") or die(debug(mysqli_error($db)));
                            while ($ROW = mysqli_fetch_array($rqt)){ $row = (object) $ROW; ?>
                                <option value="<?= $row->id ?>"><?="$row->title. $row->firstname $row->lastname"?></option>
                        <?php } ?>
                        <input type="hidden" name="CON_47" value="true">
                    </select>
                </div>
                <div class="col-xl-2 col-lg-6 col-12 form-group">
                    <label>Semestre *</label>
                    <select class="select2" name="part">
                        <option value=1>Premier Semestre</option>
                        <option value=2>Second Semestre</option>
                        <option value=3>Troisième Semestre</option>
                        <option value=4>Quatrième Semestre</option>
                        <option value=5>Cinquième Semestre</option>
                        <option value=6>Sixième Semestre</option>
                    </select>
                </div>
                <div class="col-xl-2 col-lg-6 col-12 form-group">
                    <label>Code du cours *</label>
                    <input type="text" name="code" placeholder="" class="form-control">
                </div>
                <div class="col-xl-1 col-lg-6 col-12 form-group">
                    <label>Crédit *</label>
                    <input pattern type=number step=0.1 max=20 min=0 title="Ce champs ne prend que des valeurs numérique (entier ou decimale)..." name="credit" placeholder="" class="form-control">
                </div>
                <div class="mx-4 alert hidden alert-danger alert-dismissible fade show" role="alert" id="errorRapport">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <strong>Erreur : </strong>Une erreur s'est produit pendant l'ajout.<br>Si celà persiste veuillez contacter votre administrateur système.
                </div>
                <div class="col-12 form-group mg-t-8">
                    <button type="submit" class="btn-fill-lg btn-gradient-yellow btn-hover-bluedark">Save</button>
                    <button type="reset" class="btn-fill-lg bg-blue-dark btn-hover-yellow">Reset</button>
                </div>
            </div>
        </form>
    </div>
</div>
